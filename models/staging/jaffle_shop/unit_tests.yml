unit_tests:
  - name: test_order_status_cleanup
    description: Test my status case / when cleanup logic
    model: stg_orders
    given: 
      - input: source{'jaffle_shop', 'orders'}
        rows: 
         - {id: 1, status: returned}
         - {id: 2, status: return_pending}       
         - {id: 3, status: completed}
         - {id: 4, status: pending}        
         - {id: 5, status: shipped}
         - {id: 6, status: placed}    
         - {id: 7, status: shipped_pending}      
  
    expect: 
      rows:
        - {order_id: 1, status: returned}        
        - {order_id: 2, status: returned}        
        - {order_id: 3, status: completed}        
        - {order_id: 4, status: placed}        
        - {order_id: 5, status: shipped}        
        - {order_id: 6, status: placed}    
        - {order_id: 7, status: shipped}         